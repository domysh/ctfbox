<!DOCTYPE html><html lang="en" data-mantine-color-scheme="dark"><head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CTFBox</title>
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="/favicon.svg">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    <meta name="theme-color" content="#ffffff">
    <script type="module" crossorigin="" src="/assets/index-C8DIVgYu.js"></script>
    <link rel="stylesheet" crossorigin="" href="/assets/index-Dl8Qx5np.css">
  </head>
  <body>
    <div id="root"><style data-mantine-styles="classes">@media (max-width: 35.99375em) {.mantine-visible-from-xs {display: none !important;}}@media (min-width: 36em) {.mantine-hidden-from-xs {display: none !important;}}@media (max-width: 47.99375em) {.mantine-visible-from-sm {display: none !important;}}@media (min-width: 48em) {.mantine-hidden-from-sm {display: none !important;}}@media (max-width: 61.99375em) {.mantine-visible-from-md {display: none !important;}}@media (min-width: 62em) {.mantine-hidden-from-md {display: none !important;}}@media (max-width: 74.99375em) {.mantine-visible-from-lg {display: none !important;}}@media (min-width: 75em) {.mantine-hidden-from-lg {display: none !important;}}@media (max-width: 87.99375em) {.mantine-visible-from-xl {display: none !important;}}@media (min-width: 88em) {.mantine-hidden-from-xl {display: none !important;}}</style><style data-mantine-styles="inline">:root{--app-shell-header-height:calc(3.75rem * var(--mantine-scale));--app-shell-header-offset:calc(3.75rem * var(--mantine-scale));--app-shell-padding:var(--mantine-spacing-md);}</style><div class="m_89ab340 mantine-AppShell-root" style="--app-shell-transition-duration: 200ms; --app-shell-transition-timing-function: ease;"><header class="m_3b16f56b mantine-AppShell-header right-scroll-bar-position" data-with-border="true" style="--app-shell-header-z-index: 100;"><div class="center-flex" style="height: 100%;"><div class="" style="width: var(--mantine-spacing-md); min-width: var(--mantine-spacing-md);"></div><img class="m_9e117634 mantine-Image-root" src="/logo.png" alt="CTFBox Logo" width="40" height="40"><h2 class="m_8a5d1357 mantine-Title-root" data-order="2" style="--title-fw: var(--mantine-h2-font-weight); --title-lh: var(--mantine-h2-line-height); --title-fz: var(--mantine-h2-font-size); margin-left: calc(0.3125rem * var(--mantine-scale));">CTFBox</h2><div class="" style="flex: 1 1 0%;"></div><div class="center-flex"><h5 class="m_8a5d1357 mantine-Title-root" data-order="5" style="--title-fw: var(--mantine-h5-font-weight); --title-lh: var(--mantine-h5-line-height); --title-fz: var(--mantine-h5-font-size);"><a href="/rules"><button class="mantine-focus-auto mantine-active m_77c9d27d mantine-Button-root m_87cf2631 mantine-UnstyledButton-root" data-variant="filled" type="button" style="--button-bg: var(--mantine-color-cyan-filled); --button-hover: var(--mantine-color-cyan-filled-hover); --button-color: var(--mantine-color-white); --button-bd: calc(0.0625rem * var(--mantine-scale)) solid transparent;"><span class="m_80f1301b mantine-Button-inner"><span class="m_811560b9 mantine-Button-label">Rules</span></span></button></a></h5><div class="" style="width: var(--mantine-spacing-md); min-width: var(--mantine-spacing-md);"></div><h5 class="m_8a5d1357 mantine-Title-root" data-order="5" style="--title-fw: var(--mantine-h5-font-weight); --title-lh: var(--mantine-h5-line-height); --title-fz: var(--mantine-h5-font-size);"><a href="/scoreboard"><button class="mantine-focus-auto mantine-active m_77c9d27d mantine-Button-root m_87cf2631 mantine-UnstyledButton-root" data-variant="outline" type="button" style="--button-bg: transparent; --button-hover: var(--mantine-color-cyan-outline-hover); --button-color: var(--mantine-color-cyan-outline); --button-bd: calc(0.0625rem * var(--mantine-scale)) solid var(--mantine-color-cyan-outline);"><span class="m_80f1301b mantine-Button-inner"><span class="m_811560b9 mantine-Button-label">Scoreboard</span></span></button></a></h5><div class="" style="width: var(--mantine-spacing-md); min-width: var(--mantine-spacing-md);"></div></div></div></header><main class="m_8983817 mantine-AppShell-main" style="position: relative;"><div class="m_7485cace mantine-Container-root" data-fluid="true"><div class=""><h1 class="m_8a5d1357 mantine-Title-root" data-order="1" style="--title-fw: var(--mantine-h1-font-weight); --title-lh: var(--mantine-h1-line-height); --title-fz: var(--mantine-h1-font-size); margin-top: var(--mantine-spacing-lg);">Rules</h1><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-lg);">Welcome to CTFBox, a simulation tool for Attack Defence CTF competitions.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-lg);">The infrastruture is inspired from CyberChallenge A/D infrastructure, some parts of the rules are taken from there</p><h2 class="m_8a5d1357 mantine-Title-root" data-order="2" style="--title-fw: var(--mantine-h2-font-weight); --title-lh: var(--mantine-h2-line-height); --title-fz: var(--mantine-h2-font-size); margin-top: var(--mantine-spacing-lg);">Network and Setup</h2><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-lg);">The game is played within the 10.0.0.0/8 subnet. Each team has its own vulnerable machine located at 10.60.team_id.1, while players connecting to the game network are assigned an ip in the 10.80.team_id.1/24 subnet.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">The ip address <u>10.60.0.1</u> is assigned as NOP Team (Non-playing team) vulnerable VM, this VM will not be patched during the competition and its flags will not count towards the scoreboard you can use it to test your attacks.</p><div class="center-flex" style="margin-top: var(--mantine-spacing-lg);"><img class="m_9e117634 mantine-Image-root" src="/images/network-1nop.svg" alt="Network Diagram" style="max-width: calc(50rem * var(--mantine-scale));"></div><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-lg);">The Game System is responsible for dispatching flags to the vulnerable machines, checking services integrity, hosting the scoreboard and updating scores. Participants are asked to attack vulnerable machines of other teams to retrieve proofs of successful exploitation (flags). Flags must be submitted to the flag submission service hosted by the organisers to score points. At the same time, teams must defend the vulnerable services installed on their VMs. Teams can do whatever they want within their network segment.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Internet access is granted to install new software on the VM and on the laptops of participants, if needed. Organisers discourage interaction between CTF network and remote servers (e.g., starting attacks from cloud): bruteforce attacks or large computational resources are not required to succeed at the competition.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Beware that if you mess up your vulnerable machine, all we can do is reset it to its original state (backup your exploits, tools and patches!). Resetting a vulnerable machine and return to a valid game state can take a long time and may lead to a high loss of points in the competition.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);"><u>The data in the VM is not persistent: Rebooting the VM = Reset!</u></p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Default SSH user for the VM is root and the password is your team token and will be sent to the teams before the competition start.</p><h2 class="m_8a5d1357 mantine-Title-root" data-order="2" style="--title-fw: var(--mantine-h2-font-weight); --title-lh: var(--mantine-h2-line-height); --title-fz: var(--mantine-h2-font-size); margin-top: var(--mantine-spacing-lg);">Scoring</h2><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-lg);">The game is divided in rounds (also called ticks) with the duration of <u>30 s</u>. During each round, a bot will add new flags to your vulnerable machine. Moreover it will check the integrity of services by interacting with them and by retrieving the flags through legitimate accesses.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Your team gains points by attacking other teams and by keeping services up and running. The total score is the sum of the individual scores for each service. The score per service is made of two components:</p><ul class="m_abbac491 mantine-List-root" style="margin-top: var(--mantine-spacing-md);"><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Offense: Points for flags captured from other teams and submitted to the Game System within their validity period</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">SLA: % for the availability and correct behavior of your services (up tick / total tick)</span></div></li></ul><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">The score for a flag of a service stolen by an attacking team attacker from a victim team victim will be assigned dynamically according to the formula:</p><pre class="m_b183c0a2 mantine-Code-root" data-block="true" dir="ltr" style="margin-top: var(--mantine-spacing-md);">scale = 15 * sqrt(5) 
norm = ln(ln(5)) / 12 
offense_points[flag] = scale / (1+exp((sqrt(score[attacker][service]) - sqrt(score[victim][service]))*norm))
defense_points[flag] = min(victim_score, offense_points)</pre><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">According to the previous pseudocode, the attacking team will be assigned offense_points points and the victime team will loose defense_points points:</p><pre class="m_b183c0a2 mantine-Code-root" data-block="true" dir="ltr" style="margin-top: var(--mantine-spacing-md);"># Service base points 
score[team][service] = 5000 
          
# Sum offensive points 
for flag in stolen_flags[team][service]:
  score[team][service] += offense_points[flag] 

# Substract defensive points 
for flag in lost_flags[team][service]: 
  score[team][service] -= defense_points[flag]</pre><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">The final team score will be the sum of the score for each service multiplied by its service SLA %.</p><pre class="m_b183c0a2 mantine-Code-root" data-block="true" dir="ltr" style="margin-top: var(--mantine-spacing-md);">total_score[team] = 0 
            
for service in services: 
  # Compute SLA of the service
  sla[team][service] = ticks_up[team][service] / ticks[team][service] 
  # Limit scores to 0
  score[team][service] = max(0, score[team][service]) 
  # Add service score
  total_score[team] += score[team][service] * sla[team][service]</pre><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Some consideration about the scoring system:</p><ul class="m_abbac491 mantine-List-root" style="margin-top: var(--mantine-spacing-md);"><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">SLA % it is not added to the final score but it is a multiplying factor of the total score</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">The score of a valid flag is correlated by the difference in service score of the two teams</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">You will gain more points stealing flags from teams with higher service score</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">You will gain less points stealing flags from teams with lower service score</span></div></li></ul><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">For each team, the scoreboard will list the total score and for each service its flag points, the number of captured and lost flags, the SLA in % and three different status indicators for the various types of possible failures that can occured in your services.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">In each round, at most three different kind of checks will take place on your services:</p><ul class="m_abbac491 mantine-List-root" style="margin-top: var(--mantine-spacing-md);"><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Check SLA: it checks the availability of the service</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Put flag: it puts a new flag in the service</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Get flag: it try to retrieve a valid previously inserted flag. Please note that this check is not going to be performed if previous N put flag checks failed (where N is the flag lifetime).</span></div></li></ul><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Please note that, regarding the SLA %, a service is considered up (ticks_up[team][service]) only when every check performed in a round is successful (OK).</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Since there are countless ways to break a service, the scoreboard may be not provide full information if a service is marked as corrupt or mumble. Try to restore the service from your backup (please backup it before applying any patch) and check if the service is marked as up in few minutes.</p><h2 class="m_8a5d1357 mantine-Title-root" data-order="2" style="--title-fw: var(--mantine-h2-font-weight); --title-lh: var(--mantine-h2-line-height); --title-fz: var(--mantine-h2-font-size); margin-top: var(--mantine-spacing-lg);">Flags</h2><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-lg);">A flag is a string made up of 31 uppercase alphabetic or numeric chars, followed by =. Each flag is matched by the regular expression <u>[A-Z0-9]{31}=</u>.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">You can submit stolen flags by performing an HTTP PUT request to the Game System at http://10.10.0.1:8080/flags. The flags must be submitted as an array of strings and the requests must contains the header X-Team-Token set to the team token given to the participants.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);"><u>Note: the flag submission is rate limited to a maximum of 1 requests per  and each request will elaborate up to 3000 flags, flags exceeding this limit will be ignored and must be submitted in another request.</u></p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">As an example, we provide a simple python snippet that accounts for the submission of two flag using.</p><pre class="m_b183c0a2 mantine-Code-root" data-block="true" dir="ltr" style="margin-top: var(--mantine-spacing-md);">import requests

TEAM_TOKEN = '4242424242424242'

flags = ['AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=', 'BBBBBBBBBBBBBBBBBBBBBBBBBBBBBBB=']

print(requests.put('http://10.10.0.1:8080/flags', headers={
    'X-Team-Token': TEAM_TOKEN
}, json=flags).text)</pre><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">The request will return a json array, for each sent flag you will receive an object in the form of:</p><pre class="m_b183c0a2 mantine-Code-root" data-block="true" dir="ltr" style="margin-top: var(--mantine-spacing-md);">{
    "msg": f"[{flag}] {message}",
    "flag": flag,
    "status": "ACCEPTED"/"DENIED"/"RESUBMIT"/"ERROR"
}</pre><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Where message can be:</p><ul class="m_abbac491 mantine-List-root" style="margin-top: var(--mantine-spacing-md);"><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Accepted: X flag points</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Denied: invalid flag</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Denied: flag from nop team</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Denied: flag is your own</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Denied: flag too old</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Denied: flag already claimed</span></div></li></ul><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Please note that the request status code != 200 means that the request is malformed, team token header is not valid or the game is ended. In any case there is going to be a description of the problem in the response body.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">Flags are considered expired after 5 rounds. It means that teams have up to 2 m, 30 s to steal a flag and submit it. At the same time, the check bot will try to retrieve one of the last 5 flags from a service to check if the intended functionalities have been preserved and mark it as up.</p><h2 class="m_8a5d1357 mantine-Title-root" data-order="2" style="--title-fw: var(--mantine-h2-font-weight); --title-lh: var(--mantine-h2-line-height); --title-fz: var(--mantine-h2-font-size); margin-top: var(--mantine-spacing-lg);">Flag IDs</h2><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-lg);">Some services have "Flag ID"s, additional information that you might need for an exploit. Usually this is the username of the Game System's account that stores the flag. The flag ids are only given for flags that are still valid.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">FlagIds can be retrieved by performing an HTTP GET request to the Game System at <a href="http://10.10.0.1:8081/flagIds">http://10.10.0.1:8081/flagIds?team=0&amp;service=ServiceName&amp;round=1</a>. The request query parameters are optional and can be used to filter the results.</p><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">The request will return a json array, you will receive a json format like this:</p><pre class="m_b183c0a2 mantine-Code-root" data-block="true" dir="ltr" style="margin-top: var(--mantine-spacing-md);">{
  "foobar": {
    "1": {
      "5" : {
        "flag_id_description": "flag_id_service_foobar_team_1_round_5"
      }
    },
    ...
  },
  ...
}</pre><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-md);">The flag id format depends on the service, and could also not exist for a particular service</p><h2 class="m_8a5d1357 mantine-Title-root" data-order="2" style="--title-fw: var(--mantine-h2-font-weight); --title-lh: var(--mantine-h2-line-height); --title-fz: var(--mantine-h2-font-size); margin-top: var(--mantine-spacing-lg);">Technical and Human Behaviour</h2><p class="mantine-focus-auto m_b6d8b162 mantine-Text-root" style="margin-top: var(--mantine-spacing-lg);">We'd like everyone to enjoy a fair game. For this reason we ask you to follow these simple rules:</p><ul class="m_abbac491 mantine-List-root" style="margin-top: var(--mantine-spacing-md);"><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">You are only allowed to attack targets on the subnet 10.60.0.0/16, Players are not allowed to attack each other (e.g. you can't break into opponents' laptops)</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">No attacks against the infrastructure including denial-of-service (DoS), floods, DNS poisoning, ARP spoofing, MITM, etc...</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Unfair practices are not allowed. These include any action aimed at hindering others or exploiting advantages not related to skills and preparation. Attacks against the availability of other team services (breaking it, replacing/deleting flags, etc...) fall into this category.</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">Sharing flags, exploits or hints between teams is severely prohibited and will grant you the exclusion from the competition</span></div></li><li class="m_abb6bec2 mantine-List-item"><div class="m_75cd9f71 mantine-List-itemWrapper"><span class="mantine-List-itemLabel">When in doubt, ask to the organizers</span></div></li></ul><div class="" style="height: var(--mantine-spacing-xl); min-height: var(--mantine-spacing-xl);"></div></div></div></main></div></div>
  

<div data-portal="true"><div><div class="m_9df02822 mantine-Modal-root" style="--modal-y-offset: 5dvh; --mb-z-index: 201;"></div></div></div></body></html>